# rvu-dash

Dashboard built on Streamlit to display RVU information for a provider group.

# How it works

_After several months of not working on this project, read this to get back up to speed on how the project works._

- Entry point: `/app.py`
- Authentication: `src/auth.py`

# Dev setup

- Codespaces container
  - Configured through `.devcontainer/devcontainer.json` *(generated by VSCode Codespaces: Add Dev Container Config Files... for python 3.10)*
  - As of 3/2023, per [Streamlit Cloud docs](https://docs.streamlit.io/streamlit-community-cloud/get-started/deploy-an-app), the Python 3.10 is the latest version supported
- Python and virtual environment
  - Python version specified in Codespaces container (see above)
  - Package management via [pipenv](https://pipenv-fork.readthedocs.io/en/latest/)
  - `bin/upgrade.sh`: upgrade pipenv, pip, and dependencies in Pipfile.
    - All dependencies in `Pipfile` are set to `= "*"`, so updating dependencies will pull in latest major/minor versions, including breaking changes.
  - `pipenv shell` to activate virtual env before doing work  
  - Pylance linter
    - Missing imports warnings: `Preferences: Open Workspace Settings > Extensions > Pylance > Python > Analysis: Extra Paths`. Add `/home/vscode/.local/share/virtualenvs/<...>/lib/python3.10/site-packages`. Replace `<...>` with actual path. This creates `.vscode/settings.json`.
- Run locally in Codespaces
  - `bin/start.sh`: start `streamlit` server inside pipenv. [Disable CORS in codespace](https://github.com/orgs/community/discussions/18038). The interactive commands are:
    ```
    pipenv shell
    streamlit run app.py --server.enableCORS false --server enableXsrfProtection false
    ```
- Setup VSCode to run locally
  - Update Pylance Extra Paths setting as above
  - Command `Python: Select Interpreter > select virtual env from pipenv`
  - Command `Debug: Add Configuration... > Python > Module > streamlit`. Update config in `.vscode/launch.json` to:
    ```
    {
      "name": "Streamlit",
      "type": "python",
      "request": "launch",
      "module": "streamlit",
      "args": ["run", "app.py"],
      "justMyCode": true
    }
    ```
  - Now F5 should start streamlit to debug ([reference](https://medium.com/codefile/how-to-run-your-streamlit-apps-in-vscode-3417da669fc))
- Deploy to Streamlit Cloud
  - Push to repo will automatically redeploy to https://rvu-dash.streamlit.app/
  - Manage app, including secrets, at https://share.streamlit.io/